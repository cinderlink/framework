{"version":3,"file":"zod-plugin.js","sourceRoot":"","sources":["zod-plugin.ts"],"names":[],"mappings":"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","sourcesContent":["import { ZodPluginBase, TypedIncomingMessage, EventPayloadType, type CinderlinkClientInterface, type IncomingP2PMessage } from '@cinderlink/core-types';\nimport type { Stream } from '@libp2p/interface';\nimport * as lp from 'it-length-prefixed';\nimport { pipe } from 'it-pipe';\nimport map from 'it-map';\nimport * as json from 'multiformats/codecs/json';\nimport { protocolSchemas } from './zod-schemas.js';\nimport { decodePayload } from './encoding.js';\n\n/**\n * Cinderlink Protocol Plugin implemented with Zod validation\n * \n * This plugin handles the core Cinderlink protocol for P2P communication,\n * including identity exchange, keepalive messages, and request routing.\n */\nexport class CinderlinkProtocolZodPlugin extends ZodPluginBase<\n  typeof protocolSchemas,\n  CinderlinkClientInterface\n> {\n  private keepAliveTimers: Map<string, NodeJS.Timeout> = new Map();\n  \n  constructor(client: CinderlinkClientInterface) {\n    super('cinderlink', client, protocolSchemas);\n  }\n  \n  async start(): Promise<void> {\n    await this.initializeHandlers();\n    this.logger.info('Starting Cinderlink protocol handler');\n    \n    // Register protocol handler with libp2p\n    await this.client.ipfs.libp2p.handle(\n      '/cinderlink/1.0.0',\n      this.handleProtocol.bind(this)\n    );\n    \n    // Subscribe to peer events\n    await (this.client as any).subscribe('/peer/connect');\n    await (this.client as any).subscribe('/peer/disconnect');\n    \n    this.started = true;\n    this.logger.info('Protocol handler started');\n  }\n  \n  async stop(): Promise<void> {\n    this.logger.info('Stopping protocol handler');\n    \n    // Clear all keepalive timers\n    for (const timer of this.keepAliveTimers.values()) {\n      clearTimeout(timer);\n    }\n    this.keepAliveTimers.clear();\n    \n    // Unregister protocol handler\n    await this.client.ipfs.libp2p.unhandle('/cinderlink/1.0.0');\n    \n    // Unsubscribe from peer events\n    await (this.client as any).unsubscribe('/peer/connect');\n    await (this.client as any).unsubscribe('/peer/disconnect');\n    \n    this.started = false;\n    this.logger.info('Protocol handler stopped');\n  }\n  \n  /**\n   * Handle incoming protocol streams\n   */\n  private async handleProtocol({ stream, connection }: { stream: Stream; connection: any }) {\n    const peerId = connection.remotePeer;\n    \n    try {\n      await pipe(\n        stream.source,\n        lp.decode,\n        async (source: AsyncIterable<any>) => {\n          for await (const msg of source) {\n            // Convert Uint8ArrayList to Uint8Array if needed\n            const data = msg.subarray ? msg.subarray() : new Uint8Array(msg);\n            await this.handleProtocolMessage(data, peerId);\n          }\n        }\n      );\n    } catch (error) {\n      this.logger.error('Protocol stream error', {\n        peer: peerId.toString(),\n        error: error instanceof Error ? error.message : String(error)\n      });\n      \n      this.emit('protocol:error', {\n        error: error instanceof Error ? error.message : String(error),\n        peer: {\n          peerId: peerId.toString()\n        }\n      });\n    } finally {\n      stream.close();\n    }\n  }\n  \n  /**\n   * Handle a single protocol message\n   */\n  private async handleProtocolMessage(data: Uint8Array, peerId: any) {\n    try {\n      const message = json.decode(data) as { topic: string; payload: any };\n      const { topic, payload: encodedPayload } = message;\n      \n      // Decode the payload\n      const decoded = await decodePayload(encodedPayload, this.client.did);\n      \n      if (!decoded.sender) {\n        this.logger.warn('Ignoring message without sender', { peerId: peerId.toString() });\n        return;\n      }\n      \n      // Get or create peer\n      let peer = this.client.peers.getPeer(peerId.toString());\n      if (!peer) {\n        peer = this.client.peers.addPeer(peerId, 'peer');\n      }\n      \n      // Update peer DID if not set\n      if (!peer.did && decoded.sender) {\n        peer.did = decoded.sender;\n        this.client.emit('/peer/authenticated', peer);\n      }\n      \n      // Create incoming message\n      const incoming: IncomingP2PMessage = {\n        peer,\n        topic,\n        ...decoded\n      } as any;\n      \n      // Handle specific protocol messages\n      switch (topic) {\n        case '/cinderlink/keepalive':\n          await this.handleKeepAlive(incoming);\n          break;\n          \n        case '/cinderlink/identity':\n          await this.handleIdentity(incoming);\n          break;\n          \n        case '/cinderlink/ping':\n          await this.handlePing(incoming);\n          break;\n          \n        case '/cinderlink/pong':\n          await this.handlePong(incoming);\n          break;\n          \n        default:\n          // Route to appropriate handler\n          if (topic.startsWith('/cinderlink/request/')) {\n            const requestId = (decoded.payload as any)?.requestId;\n            if (requestId) {\n              (this.client as any).emit(`/cinderlink/request/${requestId}`, incoming);\n            }\n          } else {\n            // Emit to P2P handlers\n            (this.client.p2p as any).emit(topic, incoming);\n          }\n      }\n    } catch (error) {\n      this.logger.error('Failed to handle protocol message', {\n        peer: peerId.toString(),\n        error: error instanceof Error ? error.message : String(error)\n      });\n    }\n  }\n  \n  /**\n   * Handle keepalive messages\n   */\n  private handleKeepAlive(message: IncomingP2PMessage) {\n    const peerId = message.peer.peerId.toString();\n    \n    // Validate payload\n    const payload = this.validateEventPayload('receive', '/cinderlink/keepalive', message.payload);\n    \n    // Reset keepalive timer\n    const existingTimer = this.keepAliveTimers.get(peerId);\n    if (existingTimer) {\n      clearTimeout(existingTimer);\n    }\n    \n    const timer = setTimeout(() => {\n      this.logger.warn('Peer keepalive timeout', { peerId });\n      this.client.peers.updatePeer(peerId, { connected: false });\n    }, this.client.keepAliveTimeout);\n    \n    this.keepAliveTimers.set(peerId, timer);\n    \n    // Update peer as connected\n    this.client.peers.updatePeer(peerId, { connected: true });\n  }\n  \n  /**\n   * Handle identity messages\n   */\n  private async handleIdentity(message: IncomingP2PMessage) {\n    const payload = this.validateEventPayload('receive', '/cinderlink/identity', message.payload);\n    \n    // Update peer identity\n    this.client.peers.updatePeer(message.peer.peerId.toString(), {\n      did: payload.did\n    });\n    \n    // Send our identity back\n    await this.send(\n      message.peer.peerId.toString(),\n      '/cinderlink/identity',\n      {\n        did: this.client.did.id,\n        publicKey: this.client.did.id // In production, include actual public key\n      }\n    );\n  }\n  \n  /**\n   * Handle ping messages\n   */\n  private async handlePing(message: IncomingP2PMessage) {\n    const payload = this.validateEventPayload('receive', '/cinderlink/ping', message.payload);\n    \n    // Send pong response\n    await this.send(\n      message.peer.peerId.toString(),\n      '/cinderlink/pong',\n      {\n        timestamp: Date.now(),\n        latency: Date.now() - payload.timestamp\n      }\n    );\n  }\n  \n  /**\n   * Handle pong messages\n   */\n  private handlePong(message: IncomingP2PMessage) {\n    const payload = this.validateEventPayload('receive', '/cinderlink/pong', message.payload);\n    \n    this.logger.debug('Received pong', {\n      peer: message.peer.peerId.toString(),\n      latency: payload.latency\n    });\n  }\n  \n  /**\n   * Get validated event handlers\n   */\n  protected getEventHandlers() {\n    return {\n      pubsub: {\n        '/peer/connect': (message: TypedIncomingMessage<EventPayloadType<typeof protocolSchemas, 'subscribe', '/peer/connect'>>) => {\n          this.logger.debug('Peer connected via pubsub', message.payload);\n        },\n        \n        '/peer/disconnect': (message: TypedIncomingMessage<EventPayloadType<typeof protocolSchemas, 'subscribe', '/peer/disconnect'>>) => {\n          this.logger.debug('Peer disconnected via pubsub', message.payload);\n          \n          // Clear keepalive timer\n          const timer = this.keepAliveTimers.get(message.payload.peerId);\n          if (timer) {\n            clearTimeout(timer);\n            this.keepAliveTimers.delete(message.payload.peerId);\n          }\n        }\n      }\n    };\n  }\n}\n\n/**\n * Create a Cinderlink protocol plugin instance\n */\nexport function createProtocolPlugin() {\n  return CinderlinkProtocolZodPlugin;\n}"]}